// Copyright (c) 2012-2022 John Nesky and contributing authors, distributed under the MIT license, see accompanying the LICENSE.md file.

import { DictionaryArray, BeepBoxOption, InstrumentType, toNameMap, TypePresets } from "../synth/SynthConfig";

export interface PresetCategory extends BeepBoxOption {
    readonly presets: DictionaryArray<Preset>;
}

export interface Preset extends BeepBoxOption {
    readonly isNoise?: boolean;
    readonly isMod?: boolean;
    readonly generalMidi?: boolean;
    readonly midiProgram?: number;
    readonly midiSubharmonicOctaves?: number;
    readonly customType?: InstrumentType;
    readonly settings?: any;
    
}

export const isMobile: boolean = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|android|ipad|playbook|silk/i.test(navigator.userAgent);

export function prettyNumber(value: number): string {
    return value.toFixed(2).replace(/\.?0*$/, "");
}

export class EditorConfig {
    public static readonly version: string = "0.1"; // Using patch versions in display right now, maybe TODAY. // choptop84 here who wrote this??
    public static readonly versionDisplayName: string = "BulbBox " + EditorConfig.version;

    public static readonly releaseNotesURL: string = "./patch_notes.html";

    public static readonly isOnMac: boolean = /^Mac/i.test(navigator.platform) || /Mac OS X/i.test(navigator.userAgent) || /^(iPhone|iPad|iPod)/i.test(navigator.platform) || /(iPhone|iPad|iPod)/i.test(navigator.userAgent);
    public static readonly ctrlSymbol: string = EditorConfig.isOnMac ? "⌘" : "Ctrl+";
    public static readonly ctrlName: string = EditorConfig.isOnMac ? "command" : "control";

    public static customSamples: string[] | null;
	
    public static showSongDetailsAlert: boolean = true;
	
    public static readonly presetCategories: DictionaryArray<PresetCategory> = toNameMap([
        {
            name: "Custom Instruments", presets: <DictionaryArray<Preset>>toNameMap([
                { name: TypePresets[InstrumentType.chip], customType: InstrumentType.chip },
                { name: TypePresets[InstrumentType.fm], customType: InstrumentType.fm },
                { name: TypePresets[InstrumentType.noise], customType: InstrumentType.noise },
                { name: TypePresets[InstrumentType.spectrum], customType: InstrumentType.spectrum },
                { name: TypePresets[InstrumentType.drumset], customType: InstrumentType.drumset },
                { name: TypePresets[InstrumentType.harmonics], customType: InstrumentType.harmonics },
                { name: TypePresets[InstrumentType.pwm], customType: InstrumentType.pwm },
                { name: TypePresets[InstrumentType.pickedString], customType: InstrumentType.pickedString },
                { name: TypePresets[InstrumentType.supersaw], customType: InstrumentType.supersaw },
                { name: TypePresets[InstrumentType.customChipWave], customType: InstrumentType.customChipWave },
                { name: TypePresets[InstrumentType.fm6op], customType: InstrumentType.fm6op },
            ])
        },
        {
            name: "Base Instruments", presets: <DictionaryArray<Preset>>toNameMap([
                { name: "Square Wave", midiProgram: 80, settings: { "type": "chip", "eqFilter": [], "effects": ["aliasing"], "transition": "normal", "fadeInSeconds": 0, "fadeOutTicks": -1, "chord": "simultaneous", "wave": "square", "unison": "none", "envelopes": [] } },
                { name: "Square Pulse", midiProgram: 80, settings: {"type":"PWM","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"effects":["panning"],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"none","pulseWidth":50,"decimalOffset":0,"envelopes":[],"isDrum":false} },
                { name: "White Noise", midiProgram: 80, settings: {"type":"noise","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"effects":["panning"],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"none","wave":"white","envelopes":[],"isDrum":false} },
                { name: "FM Sine", midiProgram: 55, settings: {"type":"FM","volume":0,"eqFilter":[],"eqFilterType":true,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"effects":["panning"],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"algorithm":"1←(2 3 4)","feedbackType":"1⟲","feedbackAmplitude":0,"operators":[{"frequency":"1×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5}],"envelopes":[],"isDrum":false} },
            ]),
        },
        {
            name: "Drum Presets", presets: <DictionaryArray<Preset>>toNameMap([
                { name: "C1 Square Kick", midiProgram: 80, settings: {"type":"FM","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"eqSubFilters1":[],"effects":["panning","pitch shift"],"pitchShiftSemitones":24,"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"algorithm":"1←(2 3 4)","feedbackType":"ALL","feedbackAmplitude":15,"operators":[{"frequency":"1×","amplitude":15,"waveform":"pulse width","pulseWidth":5},{"frequency":"100×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"100×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"100×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5}],"envelopes":[{"target":"feedbackAmplitude","envelope":"blip","inverse":false,"perEnvelopeSpeed":32,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"operatorAmplitude","envelope":"blip","inverse":false,"perEnvelopeSpeed":32,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":1},{"target":"operatorAmplitude","envelope":"blip","inverse":false,"perEnvelopeSpeed":32,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":2},{"target":"operatorAmplitude","envelope":"blip","inverse":false,"perEnvelopeSpeed":32,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":3},{"target":"pitchShift","envelope":"linear","inverse":false,"perEnvelopeSpeed":64,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":2},{"target":"noteVolume","envelope":"blip","inverse":false,"perEnvelopeSpeed":0.75,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1}],"isDrum":false} },
                { name: "C2 Snare (Part 1)", midiProgram: 80, settings: {"type":"FM","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["panning","transition type","pitch shift"],"transition":"interrupt","clicklessTransition":false,"pitchShiftSemitones":24,"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"algorithm":"1←(2 3 4)","feedbackType":"1⟲","feedbackAmplitude":0,"operators":[{"frequency":"1×","amplitude":15,"waveform":"pulse width","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5}],"envelopes":[{"target":"noteVolume","envelope":"decay","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"noteVolume","envelope":"blip","inverse":false,"perEnvelopeSpeed":0.3,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"pitchShift","envelope":"linear","inverse":false,"perEnvelopeSpeed":256,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":2}],"isDrum":false} },
                { name: "D3 Snare (Part 2)", midiProgram: 80, settings: {"type":"noise","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["panning","transition type","pitch shift"],"transition":"interrupt","clicklessTransition":false,"pitchShiftSemitones":19,"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"none","wave":"white","envelopes":[{"target":"noteVolume","envelope":"decay","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"noteVolume","envelope":"blip","inverse":false,"perEnvelopeSpeed":0.4,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"pitchShift","envelope":"linear","inverse":false,"perEnvelopeSpeed":64,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"pitchShift","envelope":"linear","inverse":false,"perEnvelopeSpeed":24,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1}],"isDrum":false} },
                { name: "A4 Hi-Hat", midiProgram: 80, settings: {"type":"FM","volume":0,"eqFilter":[{"type":"low-pass","cutoffHz":13454.34,"linearGain":2.8284}],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[{"type":"low-pass","cutoffHz":13454.34,"linearGain":2.8284}],"eqSubFilters1":[],"effects":["panning"],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"algorithm":"1←(2 3 4)","feedbackType":"ALL","feedbackAmplitude":15,"operators":[{"frequency":"1×","amplitude":15,"waveform":"pulse width","pulseWidth":5},{"frequency":"100×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"100×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"100×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5}],"envelopes":[{"target":"noteVolume","envelope":"decay","inverse":false,"perEnvelopeSpeed":15,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"noteVolume","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":0.5}],"isDrum":false} },
                { name: "FM Kick", midiProgram: 80, settings: {"type":"FM","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["panning","pitch shift","note filter"],"pitchShiftSemitones":12,"noteFilterType":false,"noteSimpleCut":10,"noteSimplePeak":0,"noteFilter":[],"noteSubFilters0":[],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"algorithm":"1 2←3←4","feedbackType":"2⟲ 3⟲ 4⟲","feedbackAmplitude":15,"operators":[{"frequency":"8×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"8×","amplitude":8,"waveform":"sine","pulseWidth":5},{"frequency":"16×","amplitude":9,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":9,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5}],"envelopes":[{"target":"operatorFrequency","envelope":"twang","inverse":false,"perEnvelopeSpeed":24,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":0},{"target":"noteVolume","envelope":"decay","inverse":false,"perEnvelopeSpeed":4,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"noteVolume","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"operatorAmplitude","envelope":"twang","inverse":false,"perEnvelopeSpeed":1,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":0},{"target":"operatorAmplitude","envelope":"swell","inverse":false,"perEnvelopeSpeed":8,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":1},{"target":"operatorAmplitude","envelope":"swell","inverse":false,"perEnvelopeSpeed":32,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":2},{"target":"operatorAmplitude","envelope":"swell","inverse":false,"perEnvelopeSpeed":8,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":3},{"target":"pitchShift","envelope":"swell","inverse":false,"perEnvelopeSpeed":32,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"operatorFrequency","envelope":"swell","inverse":false,"perEnvelopeSpeed":8,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":2},{"target":"noteVolume","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"operatorAmplitude","envelope":"decay","inverse":false,"perEnvelopeSpeed":2,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":1},{"target":"operatorAmplitude","envelope":"decay","inverse":false,"perEnvelopeSpeed":2,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":2},{"target":"operatorAmplitude","envelope":"decay","inverse":false,"perEnvelopeSpeed":2,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":3},{"target":"operatorAmplitude","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1.6,"index":1},{"target":"operatorAmplitude","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1.5,"index":2},{"target":"operatorAmplitude","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1.5,"index":3}],"isDrum":false} },
            ]),
        },
        {
            name: "Bass Presets", presets: <DictionaryArray<Preset>>toNameMap([
                { name: "Shocker Bass", midiProgram: 80, settings: {"type":"FM","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters1":[],"effects":["panning"],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"algorithm":"1←(2 3 4)","feedbackType":"4⟲","feedbackAmplitude":5,"operators":[{"frequency":"1×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":13,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":3,"waveform":"sine","pulseWidth":5},{"frequency":"10×","amplitude":9,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5}],"envelopes":[{"target":"operatorAmplitude","envelope":"twang","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":1},{"target":"operatorAmplitude","envelope":"twang","inverse":false,"perEnvelopeSpeed":64,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":3}],"isDrum":false} },
                { name: "Sawtooth Bass", midiProgram: 80, settings: {"type":"chip","volume":0,"eqFilter":[{"type":"low-pass","cutoffHz":11313.71,"linearGain":2.8284},{"type":"high-pass","cutoffHz":125,"linearGain":0.7071}],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[{"type":"low-pass","cutoffHz":11313.71,"linearGain":2.8284},{"type":"high-pass","cutoffHz":125,"linearGain":0.7071}],"effects":["panning","distortion","bitcrusher","reverb","phaser"],"distortion":71,"aliases":false,"bitcrusherOctave":6.5,"bitcrusherQuantization":57,"phaserMix":81,"phaserFreq":0,"phaserFeedback":26,"phaserStages":6,"pan":0,"panDelay":10,"reverb":39,"fadeInSeconds":0,"fadeOutTicks":12,"unison":"recurve","wave":"sawtooth","isUsingAdvancedLoopControls":false,"chipWaveLoopStart":0,"chipWaveLoopEnd":32,"chipWaveLoopMode":0,"chipWavePlayBackwards":false,"chipWaveStartOffset":0,"envelopes":[{"target":"noteVolume","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":2},{"target":"noteVolume","envelope":"twang","inverse":false,"perEnvelopeSpeed":64,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1.5}],"isDrum":false} },
                { name: "C64 Bass", midiProgram: 80, settings: {"type":"PWM","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["panning","note filter"],"noteFilterType":false,"noteSimpleCut":10,"noteSimplePeak":0,"noteFilter":[{"type":"low-pass","cutoffHz":4000,"linearGain":5.6569}],"noteSubFilters0":[{"type":"low-pass","cutoffHz":4000,"linearGain":5.6569}],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"none","pulseWidth":50,"decimalOffset":0,"envelopes":[{"target":"pulseWidth","envelope":"twang","inverse":true,"perEnvelopeSpeed":15,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"noteVolume","envelope":"twang","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1.5}],"isDrum":false} },
                { name: "SuperSaw Bass", midiProgram: 80, settings: {"type":"supersaw","volume":0,"eqFilter":[{"type":"low-pass","cutoffHz":2378.41,"linearGain":2.8284}],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[{"type":"low-pass","cutoffHz":2378.41,"linearGain":2.8284}],"effects":["panning","note filter","echo","reverb"],"noteFilterType":false,"noteSimpleCut":10,"noteSimplePeak":0,"noteFilter":[{"type":"low-pass","cutoffHz":3363.59,"linearGain":2},{"type":"high-pass","cutoffHz":148.65,"linearGain":0.5}],"noteSubFilters0":[{"type":"low-pass","cutoffHz":3363.59,"linearGain":2},{"type":"high-pass","cutoffHz":148.65,"linearGain":0.5}],"noteSubFilters1":[{"type":"low-pass","cutoffHz":4756.83,"linearGain":1.4142}],"pan":0,"panDelay":0,"echoSustain":57,"echoDelayBeats":0.5,"reverb":0,"fadeInSeconds":0,"fadeOutTicks":-1,"pulseWidth":50,"decimalOffset":0,"dynamism":100,"spread":50,"shape":0,"envelopes":[{"target":"noteVolume","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1},{"target":"noteFilterAllFreqs","envelope":"twang","inverse":false,"perEnvelopeSpeed":8,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1}],"isDrum":false} },
                { name: "Evil Bass", midiProgram: 80, settings: {"type":"Picked String","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["panning"],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"harmonics":[100,100,100,86,86,86,86,86,86,100,100,100,86,71,71,57,57,57,43,43,43,43,29,29,29,29,14,100],"unison":"inject","stringSustain":7,"envelopes":[],"isDrum":false} },
                { name: "Pulse Bass", midiProgram: 80, settings: {"type":"PWM","volume":0,"eqFilter":[{"type":"low-pass","cutoffHz":16000,"linearGain":0.125}],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[{"type":"low-pass","cutoffHz":16000,"linearGain":0.125}],"effects":["panning","transition type","note filter"],"transition":"interrupt","clicklessTransition":false,"noteFilterType":false,"noteSimpleCut":10,"noteSimplePeak":0,"noteFilter":[{"type":"peak","cutoffHz":353.55,"linearGain":4},{"type":"high-pass","cutoffHz":125,"linearGain":1}],"noteSubFilters0":[{"type":"peak","cutoffHz":353.55,"linearGain":4},{"type":"high-pass","cutoffHz":125,"linearGain":1}],"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"octave","pulseWidth":50,"decimalOffset":0,"envelopes":[{"target":"pulseWidth","envelope":"lfo","inverse":false,"perEnvelopeSpeed":1,"perEnvelopeLowerBound":0.8,"perEnvelopeUpperBound":1.2,"waveform":0},{"target":"noteVolume","envelope":"twang","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0.7,"perEnvelopeUpperBound":2},{"target":"noteVolume","envelope":"punch","inverse":false,"perEnvelopeSpeed":0,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1}],"isDrum":false} },
            ]),
        },
        {
            name: "Lead Presets", presets: <DictionaryArray<Preset>>toNameMap([
                { name: "Saw Lead", midiProgram: 80, settings: {"type":"chip","volume":0,"eqFilter":[{"type":"low-pass","cutoffHz":11313.71,"linearGain":1.4142}],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"effects":["panning","detune","distortion","echo","reverb"],"detuneCents":-10,"distortion":71,"aliases":false,"pan":0,"panDelay":10,"echoSustain":29,"echoDelayBeats":1,"reverb":16,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"octave","wave":"sawtooth","isUsingAdvancedLoopControls":false,"chipWaveLoopStart":0,"chipWaveLoopEnd":32,"chipWaveLoopMode":0,"chipWavePlayBackwards":false,"chipWaveStartOffset":0,"envelopes":[],"isDrum":false} },
                { name: "Hexefe's CoolSaw", midiProgram: 80, settings: {"type":"chip","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["transition type","vibrato","chorus","echo"],"transition":"normal","clicklessTransition":false,"vibrato":"delayed","vibratoDepth":0.3,"vibratoDelay":18.5,"vibratoSpeed":10,"vibratoType":0,"chorus":71,"echoSustain":43,"echoDelayBeats":1,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"none","wave":"sawtooth","isUsingAdvancedLoopControls":false,"chipWaveLoopStart":0,"chipWaveLoopEnd":32,"chipWaveLoopMode":0,"chipWavePlayBackwards":false,"chipWaveStartOffset":0,"envelopes":[],"isDrum":false} },
                { name: "Spooky Triangle", midiProgram: 80, settings: {"type":"chip","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["panning","vibrato","note filter","echo","reverb"],"vibrato":"custom","vibratoDepth":0.52,"vibratoDelay":10,"vibratoSpeed":10,"vibratoType":0,"noteFilterType":false,"noteSimpleCut":10,"noteSimplePeak":0,"noteFilter":[{"type":"high-pass","cutoffHz":88.39,"linearGain":0.5},{"type":"peak","cutoffHz":105.11,"linearGain":4}],"noteSubFilters0":[{"type":"high-pass","cutoffHz":88.39,"linearGain":0.5},{"type":"peak","cutoffHz":105.11,"linearGain":4}],"pan":0,"panDelay":10,"echoSustain":43,"echoDelayBeats":0.5,"reverb":29,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"none","wave":"triangle","isUsingAdvancedLoopControls":false,"chipWaveLoopStart":0,"chipWaveLoopEnd":32,"chipWaveLoopMode":0,"chipWavePlayBackwards":false,"chipWaveStartOffset":0,"envelopes":[],"isDrum":false} },
            ]),
        },
        {
            name: "Guitar Presets", presets: <DictionaryArray<Preset>>toNameMap([
                { name: "Distortion Guitar 1", midiProgram: 80, settings: {"type":"FM","volume":0,"eqFilter":[{"type":"low-pass","cutoffHz":19027.31,"linearGain":0.7071}],"eqFilterType":true,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters1":[],"effects":["panning","vibrato","note filter","distortion","bitcrusher"],"vibrato":"light","vibratoDepth":0.15,"vibratoDelay":0,"vibratoSpeed":10,"vibratoType":0,"noteFilterType":false,"noteSimpleCut":10,"noteSimplePeak":0,"noteFilter":[{"type":"high-pass","cutoffHz":88.39,"linearGain":0.5},{"type":"low-pass","cutoffHz":6727.17,"linearGain":2}],"noteSubFilters0":[{"type":"high-pass","cutoffHz":88.39,"linearGain":0.5},{"type":"low-pass","cutoffHz":6727.17,"linearGain":2}],"distortion":29,"aliases":false,"bitcrusherOctave":4.5,"bitcrusherQuantization":14,"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"algorithm":"1←(2 3 4)","feedbackType":"2⟲ 3⟲ 4⟲","feedbackAmplitude":15,"operators":[{"frequency":"1×","amplitude":15,"waveform":"pulse width","pulseWidth":5},{"frequency":"20×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"20×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"20×","amplitude":15,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5},{"frequency":"1×","amplitude":0,"waveform":"sine","pulseWidth":5}],"envelopes":[{"target":"operatorAmplitude","envelope":"blip","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":1},{"target":"operatorAmplitude","envelope":"blip","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":2},{"target":"operatorAmplitude","envelope":"blip","inverse":false,"perEnvelopeSpeed":10,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1,"index":3}],"isDrum":false} },
            ]),
        },
                {
            name: "Other Presets", presets: <DictionaryArray<Preset>>toNameMap([
                { name: "Clock Tower/Church Bell", midiProgram: 80, settings: {"type":"noise","volume":0,"eqFilter":[],"eqFilterType":false,"eqSimpleCut":10,"eqSimplePeak":0,"envelopeSpeed":12,"discreteEnvelope":false,"eqSubFilters0":[],"effects":["panning","phaser"],"phaserMix":100,"phaserFreq":81,"phaserFeedback":100,"phaserStages":103,"pan":0,"panDelay":10,"fadeInSeconds":0,"fadeOutTicks":-1,"unison":"none","wave":"white","envelopes":[{"target":"noteVolume","envelope":"twang","inverse":false,"perEnvelopeSpeed":4,"perEnvelopeLowerBound":0,"perEnvelopeUpperBound":1}],"isDrum":false} },
            ]),
        },
        

    ]);

    public static valueToPreset(presetValue: number): Preset | null {
        const categoryIndex: number = presetValue >> 6;
        const presetIndex: number = presetValue & 0x3F;
        return EditorConfig?.presetCategories[categoryIndex].presets[presetIndex];
    }

    public static midiProgramToPresetValue(program: number): number | null {
        for (let categoryIndex: number = 0; categoryIndex < EditorConfig.presetCategories.length; categoryIndex++) {
            const category: PresetCategory = EditorConfig.presetCategories[categoryIndex];
            for (let presetIndex: number = 0; presetIndex < category.presets.length; presetIndex++) {
                const preset: Preset = category.presets[presetIndex];
                if (preset.generalMidi && preset.midiProgram == program) return (categoryIndex << 6) + presetIndex;
            }
        }
        return null;
    }

    public static nameToPresetValue(presetName: string): number | null {
        for (let categoryIndex: number = 0; categoryIndex < EditorConfig.presetCategories.length; categoryIndex++) {
            const category: PresetCategory = EditorConfig.presetCategories[categoryIndex];
            for (let presetIndex: number = 0; presetIndex < category.presets.length; presetIndex++) {
                const preset: Preset = category.presets[presetIndex];
                if (preset.name == presetName) return (categoryIndex << 6) + presetIndex;
            }
        }
        return null;
    }

    public static instrumentToPreset(instrument: InstrumentType): Preset | null {
        return EditorConfig.presetCategories[0].presets.dictionary?.[TypePresets?.[instrument]];
    }
}
